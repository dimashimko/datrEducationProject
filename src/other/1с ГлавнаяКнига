//*******************************************
Перем Дата1;
Перем Дата2;
//Перем Фирма;
Перем Т;
Перем СписокСчетов;
Перем ИтогоК[10000],ИтогоД[10000];

Функция ПолучитьЖурналы(ном)
	спс=СоздатьОбъект("СписокЗначений");
	с=Создатьобъект("Справочник.Журнал");
	с.ВыбратьЭлементы();
	Пока с.ПолучитьЭлемент()=1 Цикл
		Если с.НомМО=ном Тогда
			спс.ДобавитьЗначение(с.ТекущийЭлемент());
		КонецЕсли;
	КонецЦикла;
	//ы=0;
	//спс.ВыбратьЗначение(ы);
	Возврат спс;
КонецФункции

Функция ОстНК(Д1,Д2,Сч,Журналы)
	таб=СоздатьОбъект("ТаблицаЗначений");
	таб.НоваяКолонка("ОстНД");
	таб.НоваяКолонка("ОстНК");
	таб.НоваяКолонка("ОстКД");
	таб.НоваяКолонка("ОстКК");
	ит=СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;
	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,Журналы);


	ит1=СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит1.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;

	Ит1.ИспользоватьСубконто(ВидыСубконто.Журнал,Журналы);
	Д0 = НачГода(Дата(Год, Месяц.ТекущаяСтрока(), 1));
	Д_0= ДобавитьМесяц(НачГода(Дата(Год, Месяц.ТекущаяСтрока(), 1)),-1);
	Д_01=КонМесяца(Д_0);
	Если Месяц.ТекущаяСтрока()=1 Тогда
		Д_2=0;
	Иначе
		Д_2=КонМесяца(Дата(Год, Месяц.ТекущаяСтрока()-1, 1));
	КонецЕсли;
	ит.ВыполнитьЗапрос(Д0,Д2,сч,,, 2,, "С");
	ит.ВыбратьКорСчета();
	Пока ит.ПолучитьКорСчет()=1 Цикл
		таб.НоваяСтрока();
		таб.ОстКД=ит.КОРДО();
		таб.ОстКК=ит.КОРКО();
	КонецЦикла;
	Если Д_2<>0 Тогда
		ит.ВыполнитьЗапрос(Д0,Д_2,сч,,, 2,, "С");
		ит.ВыбратьКорСчета();
		Пока ит.ПолучитьКорСчет()=1 Цикл
			таб.НоваяСтрока();
			таб.ОстНД=ит.КОРДО();
			таб.ОстНК=ит.КОРКО();
		КонецЦикла;
	КонецЕсли;
	ит1.ВыполнитьЗапрос(Д_0,Д_01,сч,,, 3,, "С");
	лл=ит1.СКД()-ит1.СКК();
	Если лл<>0 тогда
		таб.НоваяСтрока();
		таб.ОстНД=ит1.СКД();
		таб.ОстНК=ит1.СКК();
		таб.ОстКД=ит1.СКД();
		таб.ОстКК=ит1.СКК();
	КонецЕсли;
	таб.Свернуть(,"ОстНД,ОстНК,ОстКД,ОстКК");
	Если таб.КоличествоСтрок()=0 Тогда
		Возврат 0;
	Иначе
		Возврат таб;
	КонецЕсли;
КонецФункции















Процедура ПриОткрытии()
	Д = '01.01.2007';
	Пропись("grn_ukr.spl");
	Для А=1 По 12 Цикл
		С = Формат(Д, "ДММММГГ");
		С = Лев(С, СтрДлина(С)-6);
		Месяц.ДобавитьЗначение(А, С);
		Д = ДобавитьМесяц(Д, 1);
	КонецЦикла;
	Месяц.ТекущаяСтрока(ДатаМесяц(РабочаяДата()));
	Год = ДатаГод(РабочаяДата());

КонецПроцедуры