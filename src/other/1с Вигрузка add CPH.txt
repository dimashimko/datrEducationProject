Процедура ВводНового()
    ДатаДок=ПериодРаботыГл.ДатаНачала;
	Период=ПериодРаботыГл;
	Текст1=Константа.ТекстПеречисления;
КонецПроцедуры

Процедура ПровДаты()
	Если ПустоеЗначение(ДатаДок)=0 Тогда
		Если (ДатаДок<Период.ДатаНачала) Или (ДатаДок>Период.ДатаКонца) Тогда
			ДатаДок=Период.ДатаНачала;
			Предупреждение("Вводить дату можно только в периоде документа!");
			Возврат;
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры


Процедура Заполнить()
	Если КоличествоСтрок()<>0 Тогда
		Если Вопрос("Все существующие строки будут удалены, продолжить?","Да+Нет")="Да" Тогда
			УдалитьСтроки();
		Иначе
			Возврат;
		КонецЕсли;
	КонецЕсли;

    Если (ПустоеЗначение(Подразделение)=1) Или (ПустоеЗначение(Тип)=1) или(ПустоеЗначение(Банк)=1) Тогда
        Предупреждение("Заполните все реквизиты в шапке документа!");
		Возврат;
	КонецЕсли;
	Если Тип=перечисление.ТипВыплаты.Аванс Тогда
		ав=СоздатьОбъект("Документ.Аванс");
		ав.ВыбратьДокументы();
		найден=0;
		Пока ав.ПолучитьДокумент()=1 Цикл
			//Сообщить(ав.период);
			//Сообщить(ав.Подразделение);
			Если (ав.период=период) И (ав.Подразделение=Подразделение) Тогда
				найден=1;
				Прервать;

			КонецЕсли;
		КонецЦикла;
		Если найден=0 Тогда
			Предупреждение("По этому подразделению удержание аванса не производилось!!!");
			возврат;
		КонецЕсли;
		ав.ВыбратьСтроки();
		о=0;
		СумИтог=0;
		Пока ав.ПолучитьСтроку()=1 Цикл
			ес=0;
			Пер=0;
			Если ав.Сотрудник.ВторойБанк=1 Тогда
				Если (ав.Сотрудник.Банк=Банк) И (ав.Сотрудник.ТипВыплаты=Перечисление.ТипВыплаты.Аванс) Тогда
					ес=1;
					Бнк=ав.Сотрудник.Банк;
					ТехРах=ав.Сотрудник.ТехНомер;
					Пер=1;
				КонецЕсли;
				Если (ав.Сотрудник.Банк1=Банк) И (ав.Сотрудник.ТипВыплаты1=Перечисление.ТипВыплаты.Аванс) И (Пер=0) Тогда
					ес=1;
					Бнк=ав.Сотрудник.Банк1;
					ТехРах=ав.Сотрудник.ТехНомер1;
				КонецЕсли;
			Иначе
				Если (ав.Сотрудник.Банк=Банк) Тогда
					ес=1;
					Бнк=ав.Сотрудник.Банк;
					ТехРах=ав.Сотрудник.ТехНомер;
				КонецЕсли;
			КонецЕсли;
			Если (ав.Сумма=0) или (ес=0) Тогда
				Продолжить;
			КонецЕсли;
				НоваяСтрока();
				Код=ТехРах;
				сотрудник=ав.Сотрудник;
				Сумма=ав.Сумма;
//**********************
//**********************
				ТабНомер=ав.ТабНомер;
				ИнНомер=ав.ИнНомер;
//**********************
//**********************
		КонецЦикла;
		ИначеЕсли Тип=Перечисление.ТипВыплаты.Зарплата Тогда
		сотр=СоздатьОбъект("Справочник.Сотрудники");
		сотр.ВыбратьЭлементы();
		о=0;
		СумИтог=0;
		Пока сотр.ПолучитьЭлемент()=1 Цикл
			ес=0;
			Пер=0;
			Если сотр.ЭтоГруппа()=1 Тогда
				Продолжить;
			ИначеЕсли сотр.ПринадлежитГруппе(Подразделение)=0 Тогда
				Продолжить;
			КонецЕсли;
			сумПол=НачислениеСотрудникаЖурнал("Всего",сотр.ТекущийЭлемент(),период)-УдержанияСотрудникаЖурнал("Всего",сотр.ТекущийЭлемент(),период);
			Если сумПол<=0 Тогда
				Продолжить;
			КонецЕсли;

				Если сотр.ВторойБанк=1 Тогда
					Если (сотр.Банк=Банк) И (сотр.ТипВыплаты=Перечисление.ТипВыплаты.Зарплата) Тогда
						ес=1;
						Пер=0;
						Бнк=сотр.Банк;
						ТехРах=сотр.ТехНомер;
					КонецЕсли;
					Если (сотр.Банк1=Банк) И (сотр.ТипВыплаты1=Перечисление.ТипВыплаты.Зарплата) И (Пер=0) Тогда
						ес=1;
						Бнк=сотр.Банк1;
						ТехРах=сотр.ТехНомер1;
					КонецЕсли;
				Иначе
					Если (сотр.Банк<>Банк) Тогда
						Продолжить;
					Иначе
						ес=1;
						Бнк=Сотр.Банк;
						ТехРах=Сотр.ТехНомер;
					КонецЕсли;
				КонецЕсли;


			Если ес=0 Тогда
				Продолжить;
			КонецЕсли;
			НоваяСтрока();
			Код=ТехРах;
//**********************
//**********************
			ТабНомер=сотр.Код;
			ИнНомер=сотр.ИнНомер;
//**********************
//**********************
			сотрудник=Сотр.ТекущийЭлемент();
			Сумма=СумПол;

		КонецЦикла;
	КонецЕсли;

КонецПроцедуры

Процедура Печать()
	Высота=58;
	Если КоличествоСтрок()=0 Тогда
		Возврат;
	КонецЕсли;
	Табл=СоздатьОбъект("Таблица");
	Если Банк.Подпись=Перечисление.ДаНет.Да Тогда
		Табл.ИсходнаяТаблица("Таблица");
		Подп=1;
	Иначе
		Табл.ИсходнаяТаблица("Таблица1");
		Подп=0;
	КонецЕсли;
	НазваБанку=Банк.Наименование;
	Табл.ВывестиСекцию("Шапка1|Шапка11");
		//Сообщить(ПериодМСтрГл(06,2008));
	ИтогСтр=0;
	Если Банк.Код<>"" Тогда
		Табл.ВывестиСекцию("Шапка12|Шапка1");
	Иначе
		Табл.ВывестиСекцию("Шапка12|Верх1");
		Табл.ПрисоединитьСекцию("Шапка12|Верх3");
	КонецЕсли;
	ТекВысота=?(Подп=1,12,8);
	ИтогСтр=0;
	СумИтог=0;
	ВыбратьСтроки();
	Пока ПолучитьСтроку()=1 Цикл
		ТехРах=Код;
		ТехРах=сотрудник.ТехНомер;
		Если ТекВысота+7>=Высота Тогда
			о=НомерСтроки;
			ИтогСтр=ИтогСтр+Сумма;
			сумИтог=СумИтог+Сумма;
			сум=Сумма;
			Фио=сотрудник.Наименование;
//************************
//************************
			ТабНомер=сотрудник.Код;
			ИнНомер=сотрудник.ИнНомер;
//************************
//************************
			ТекстСтр="Всього по сторінкі:";
			СуммаПропись=ЧислоПропись(ИтогСтр);
			ЧСум=ИтогСтр;
			Если Банк.Код<>"" Тогда
				Табл.ВывестиСекцию("стр|Шапка1");
				Табл.ВывестиСекцию("Подвал|Шапка1");
			Иначе
				Табл.ВывестиСекцию("стр|Верх1");
				Табл.ПрисоединитьСекцию("стр|Верх3");
				Табл.ВывестиСекцию("Подвал|Верх1");
				Табл.ПрисоединитьСекцию("Подвал|Верх3");
			КонецЕсли;
			Табл.НоваяСтраница();
			ИтогСтр=0;
			Если Банк.Код<>"" Тогда
				Табл.ВывестиСекцию("Шапка12|Шапка1");
			Иначе
				Табл.ВывестиСекцию("Шапка12|Верх1");
				Табл.ПрисоединитьСекцию("Шапка12|Верх3");
			КонецЕсли;
			ТекВысота=?(Подп=1,12,8);
		Иначе
			сумИтог=СумИтог+Сумма;
			ИтогСтр=ИтогСтр+Сумма;
			фил=Банк.Код;
			сум=Сумма;
			о=НомерСтроки;
			Фио=сотрудник.Наименование;
//************************
//************************
			ТабНомер=сотрудник.Код;
			ИнНомер=сотрудник.ИнНомер;
//************************
//************************
			Если Банк.Код<>"" Тогда
				Табл.ВывестиСекцию("стр|Шапка1");
			Иначе
				Табл.ВывестиСекцию("стр|Верх1");
				Табл.ПрисоединитьСекцию("стр|Верх3");
			КонецЕсли;
			ТекВысота=ТекВысота+1;
		КонецЕсли;
	КонецЦИкла;

	Если Банк.Код<>"" Тогда
		ТекстСтр="Всього по сторінкі:";
		СуммаПропись=ЧислоПропись(ИтогСтр);
		чСум=ИтогСтр;
		Табл.ВывестиСекцию("Итого|Шапка1");
		СуммаПропись=ЧислоПропись(СумИтог);
		Если Подп=0 Тогда
			ТекстСтр="Всього до перерахування:";
		Иначе
			ТекстСтр="Всього до сплати:";
		КонецЕсли;

		чСум=СумИтог;
		Табл.ВывестиСекцию("подвал|Шапка1");
	Иначе
		ТекстСтр="Всього по сторінкі:";
		СуммаПропись=ЧислоПропись(ИтогСтр);
		чСум=ИтогСтр;
		Табл.ВывестиСекцию("Итого|Верх1");
		Табл.ПрисоединитьСекцию("Итого|Верх3");
		Если Подп=0 Тогда
			ТекстСтр="Всього до перерахування:";
		Иначе
			ТекстСтр="Всього до сплати:";
		КонецЕсли;
		СуммаПропись=ЧислоПропись(СумИтог);
		чСум=СумИтог;
		Табл.ВывестиСекцию("подвал|Верх1");
		Табл.ПрисоединитьСекцию("подвал|Верх3");
	КонецЕсли;
	Табл.ТолькоПросмотр(1);
	Табл.ПараметрыСтраницы(1,,,5,5,5,10,0,1,1,0,);
	Табл.Показать("Таблица для печати","");
КонецПроцедуры


Процедура Призаписи()
	Константа.ТекстПеречисления=Текст1;
	ИтоговаяСумма=Итог("Сумма");
	Если ПустоеЗначение(Тип)=1 Тогда
		Предупреждение("Задайте тип перечисления!");
		СтатусВозврата(0);
		Возврат;
	КонецЕсли;

КонецПроцедуры

Процедура ПриУдаленииСтроки()
	Если Вопрос("Подтвердите удаление строки!","Да+Нет")="Нет" Тогда
		СтатусВозврата(0);
		Возврат;
	КонецЕсли;
КонецПроцедуры
//***********************************************
//***********************************************
//***********************************************
//***********************************************
//***********************************************
//***********************************************
//***********************************************
//***********************************************

Процедура Выгрузка()
	Итог=0;
	Если Банк.Выбран()=0 Тогда
		Предупреждение("Не выбран банк!");
		Возврат;
	КонецЕсли;
	Если ПустоеЗначение(СокрЛП(Банк.Папка))=1 Тогда
		Предупреждение("Не выбрана папка экспорта в банке!");
		Возврат;
	КонецЕсли;
	Если Подразделение.Выбран()=0 Тогда
		Предупреждение("Не выбрано подразделение!");
		Возврат;
	КонецЕсли;
	Если ПустоеЗначение(СокрЛП(Подразделение.Експорт))=1 Тогда
		Предупреждение("Не выбрано имя файла экспорта в подразделении!");
		Возврат;
	КонецЕсли;
	Если Итог("Сумма")=0 Тогда
		Предупреждение("Итоговая Сумма по документу равна 0, нечего выгружать!");
		Возврат;
	КонецЕсли;
	ВыбратьСтроки();
	фл=0;
	Пока ПолучитьСтроку()=1 Цикл
		Если (ПустоеЗначение(СокрЛП(код))=1) И (Сумма<>0) Тогда
			Сообщить("В строке "+Строка(номерСтроки)+" у сотрудника нету кода, выгрузка невозможна!");

			фл=1;
		КонецЕсли;
	КонецЦИкла;
	Если фл=1 Тогда
		Возврат;
	КонецЕсли;
//Укрсоцбанк
    Если СокрЛП(Банк.Наименование) = "Укрсоцбанк" Тогда
		Если СокрЛП(Подразделение.Наименование) = "ЦБ (70804)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CB.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "СЮТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SUT.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "НВК (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\NVK.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "МК (70802)" Тогда
			имя=СокрЛП(Банк.Папка)+"\MK.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Логопед (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\LOGOPED.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ДЮСШ (130107)" Тогда
			имя=СокрЛП(Банк.Папка)+"\DUSSH.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Госп. группа (70805)" Тогда
			имя=СокрЛП(Банк.Папка)+"\HG.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "БДТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\BDT.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Апарат (10116)" Тогда
			имя=СокрЛП(Банк.Папка)+"\APARAT.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №2 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_2.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №3 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_3.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №4 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_4.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №5 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_5.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №6 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_6.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №7 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_7.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №8 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_8.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №1 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCHOOL_1.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №2 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCHOOL_2.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №3 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCHOOL_3.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №4 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCHOOL_4.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №6 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCHOOL_6.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №7 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCHOOL_7.dbf";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ЦПХ(00000)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CPH.dbf";
		КонецЕсли;
			Если ФС.СуществуетФайл(имя)=1 Тогда
				ФС.УдалитьФайл(имя);
			КонецЕсли;
			ДБФ=СоздатьОбъект("XBASE");
			ДБФ.КодоваяСтраница(0);
			ДБФ.ДобавитьПоле("PAN","C",15,);
			ДБФ.ДобавитьПоле("SUMA","N",12,2);
			ДБФ.ДобавитьПоле("FIO","C",80,);
			ДБФ.ДобавитьПоле("IDEN","C",10,);
			ДБФ.ДобавитьПоле("TN","C",20,);
			ДБФ.СоздатьФайл(имя);
			ВыбратьСтроки();
				Пока ПолучитьСтроку()=1 Цикл
					Если Сумма=0 Тогда
						Продолжить;
					КонецЕсли;
					Итог=Итог+Сумма;
				КонецЦИкла;

				ДБФ.Добавить();
				ДБФ.PAN="@29093431250009";
				ДБФ.SUMA=Итог;
				ДБФ.FIO=текст1;
				ДБФ.IDEN="02143956";
				ДБФ.TN=300023;
				ДБФ.Записать();


			Пока ПолучитьСтроку()=1 Цикл
				Если Сумма=0 Тогда
					Продолжить;
				КонецЕсли;

				ДБФ.Добавить();
				ДБФ.PAN=Сокрлп(Сотрудник.ТехНомер);
				ДБФ.SUMA=Сумма;
				ДБФ.FIO=Сокрлп(Сотрудник.Наименование);
				ДБФ.IDEN=Сокрлп(Сотрудник.ИнНомер);
				ДБФ.TN=Сокрлп(Сотрудник.код);
				ДБФ.Записать();
			КонецЦИкла;
			ДБФ="";
	КонецЕсли;

//ОЩАДбанк
    Если (Найти(СокрЛП(Банк.Наименование),"Ощад") > 0) Тогда
		Если СокрЛП(Подразделение.Наименование) = "ЦБ (70804)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CB";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "СЮТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SUT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "НВК (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\NVK";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "МК (70802)" Тогда
			имя=СокрЛП(Банк.Папка)+"\MK";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Логопед (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\LOGOPED";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ДЮСШ (130107)" Тогда
			имя=СокрЛП(Банк.Папка)+"\DUSSH";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Госп. группа (70805)" Тогда
			имя=СокрЛП(Банк.Папка)+"\HG";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "БДТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\BDT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Апарат (10116)" Тогда
			имя=СокрЛП(Банк.Папка)+"\APARAT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №2 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_2";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №3 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_3";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №4 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_4";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №5 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_5";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №6 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_6";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №7 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_7";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №8 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_8";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №1 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_1";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №2 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_2";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №3 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_3";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №4 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_4";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №6 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_6";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №7 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_7";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Инклюзия (0611020)" Тогда
			имя=СокрЛП(Банк.Папка)+"\INCL";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ІРЦ (0611161)" Тогда
			имя=СокрЛП(Банк.Папка)+"\IRC";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Петрівський НВК" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_P";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Петрівський НВК ДНЗ" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_P";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Міський центр проф.розвитку пед. працівників" Тогда
			имя=СокрЛП(Банк.Папка)+"\MCPRPP";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ЦПХ(00000)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CPH";
		КонецЕсли;


			ВыбратьСтроки();
			ПолучитьСтроку();
			врем = "_" + Сотрудник.Педагог.Получить(ПериодРаботыГл.ДатаНачала);
			Если врем = "_Да" Тогда
                имя = имя + "_y";
            Иначе
                имя = имя + "_n"
	        КонецЕсли;
            имя = имя + ".dbf";

			Если ФС.СуществуетФайл(имя)=1 Тогда
				ФС.УдалитьФайл(имя);
			КонецЕсли;

			ДБФ=СоздатьОбъект("XBASE");
			ДБФ.КодоваяСтраница(0);
			ДБФ.ДобавитьПоле("NSC","C",29,);
			ДБФ.ДобавитьПоле("SUMMA","N",20,2);
			ДБФ.ДобавитьПоле("FIO","C",38,);
			ДБФ.ДобавитьПоле("ID_KOD","C",14,);

			ДБФ.СоздатьФайл(имя);
			ВыбратьСтроки();

			Пока ПолучитьСтроку()=1 Цикл
				Если Сумма=0 Тогда
					Продолжить;
				КонецЕсли;

				ДБФ.Добавить();
				ДБФ.NSC=Сокрлп(Сотрудник.ТехНомер);
				ДБФ.SUMMA=Сумма;
				ДБФ.FIO=Сокрлп(Сотрудник.Наименование);
				ДБФ.ID_KOD=Сокрлп(Сотрудник.ИнНомер);
				ДБФ.Записать();
			КонецЦИкла;
			ДБФ="";
	КонецЕсли;

//Альфа-Банк
    Если (Найти(СокрЛП(Банк.Наименование),"Альфа-Банк") > 0) Тогда
		Если СокрЛП(Подразделение.Наименование) = "ЦБ (70804)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CB";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "СЮТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SUT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "НВК (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\NVK";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "МК (70802)" Тогда
			имя=СокрЛП(Банк.Папка)+"\MK";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Логопед (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\LOGOPED";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ДЮСШ (130107)" Тогда
			имя=СокрЛП(Банк.Папка)+"\DUSSH";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Госп. группа (70805)" Тогда
			имя=СокрЛП(Банк.Папка)+"\HG";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "БДТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\BDT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Апарат (10116)" Тогда
			имя=СокрЛП(Банк.Папка)+"\APARAT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №2 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_2";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №3 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_3";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №4 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_4";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №5 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_5";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №6 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_6";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №7 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_7";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №8 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_8";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №1 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_1";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №2 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_2";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №3 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_3";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №4 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_4";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №6 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_6";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №7 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_7";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Инклюзия (0611020)" Тогда
			имя=СокрЛП(Банк.Папка)+"\INCL";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ІРЦ (0611161)" Тогда
			имя=СокрЛП(Банк.Папка)+"\IRC";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Петрівський НВК" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_P";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Петрівський НВК ДНЗ" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_P";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Міський центр проф.розвитку пед. працівників" Тогда
			имя=СокрЛП(Банк.Папка)+"\MCPRPP";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ЦПХ(00000)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CPH";
		КонецЕсли;


			ВыбратьСтроки();
			ПолучитьСтроку();
			врем = "_" + Сотрудник.Педагог.Получить(ПериодРаботыГл.ДатаНачала);
			Если врем = "_Да" Тогда
                имя = имя + "_y";
            Иначе
                имя = имя + "_n"
	        КонецЕсли;
            имя = имя + ".dbf";

			Если ФС.СуществуетФайл(имя)=1 Тогда
				ФС.УдалитьФайл(имя);
			КонецЕсли;
			ДБФ=СоздатьОбъект("XBASE");
			ДБФ.КодоваяСтраница(0);
			ДБФ.ДобавитьПоле("ACCT_CARD","C",29,);
			ДБФ.ДобавитьПоле("FIO","C",20,);
			ДБФ.ДобавитьПоле("ID_CODE","C",10,);
			ДБФ.ДобавитьПоле("SUMA","N",10,2);

			ДБФ.СоздатьФайл(имя);
			ВыбратьСтроки();

			Пока ПолучитьСтроку()=1 Цикл
				Если Сумма=0 Тогда
					Продолжить;
				КонецЕсли;

				ДБФ.Добавить();
				ДБФ.ACCT_CARD=Сокрлп(Сотрудник.ТехНомер);
				ДБФ.FIO=Сокрлп(Сотрудник.Наименование);
				ДБФ.ID_CODE=Сокрлп(Сотрудник.ИнНомер);
				ДБФ.SUMA=Сумма;
				ДБФ.Записать();
			КонецЦИкла;
			ДБФ="";
	КонецЕсли;



//АккордБанк
    Если (Найти(СокрЛП(Банк.Наименование),"АккордБанк") > 0) Тогда
		Если СокрЛП(Подразделение.Наименование) = "ЦБ (70804)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CB";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "СЮТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SUT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "НВК (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\NVK";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "МК (70802)" Тогда
			имя=СокрЛП(Банк.Папка)+"\MK";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Логопед (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\LOGOPED";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ДЮСШ (130107)" Тогда
			имя=СокрЛП(Банк.Папка)+"\DUSSH";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Госп. группа (70805)" Тогда
			имя=СокрЛП(Банк.Папка)+"\HG";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "БДТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\BDT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Апарат (10116)" Тогда
			имя=СокрЛП(Банк.Папка)+"\APARAT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №2 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_2";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №3 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_3";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №4 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_4";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №5 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_5";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №6 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_6";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №7 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_7";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №8 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_8";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №1 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_1";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №2 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_2";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №3 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_3";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №4 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_4";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №6 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_6";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №7 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_7";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Инклюзия (0611020)" Тогда
			имя=СокрЛП(Банк.Папка)+"\INCL";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ІРЦ (0611161)" Тогда
			имя=СокрЛП(Банк.Папка)+"\IRC";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Петрівський НВК" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_P";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Петрівський НВК ДНЗ" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_P";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Міський центр проф.розвитку пед. працівників" Тогда
			имя=СокрЛП(Банк.Папка)+"\MCPRPP";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ЦПХ(00000)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CPH";
		КонецЕсли;


			ВыбратьСтроки();
			ПолучитьСтроку();
			врем = "_" + Сотрудник.Педагог.Получить(ПериодРаботыГл.ДатаНачала);
			Если врем = "_Да" Тогда
                имя = имя + "_y";
            Иначе
                имя = имя + "_n"
	        КонецЕсли;
            имя = имя + ".dbf";

			Если ФС.СуществуетФайл(имя)=1 Тогда
				ФС.УдалитьФайл(имя);
			КонецЕсли;
			ДБФ=СоздатьОбъект("XBASE");
			ДБФ.КодоваяСтраница(0);
			ДБФ.ДобавитьПоле("ACCT_CARD","C",29,);
			ДБФ.ДобавитьПоле("FIO","C",20,);
			ДБФ.ДобавитьПоле("ID_CODE","C",10,);
			ДБФ.ДобавитьПоле("SUMA","N",10,2);

			ДБФ.СоздатьФайл(имя);
			ВыбратьСтроки();

			Пока ПолучитьСтроку()=1 Цикл
				Если Сумма=0 Тогда
					Продолжить;
				КонецЕсли;

				ДБФ.Добавить();
				ДБФ.ACCT_CARD=Сокрлп(Сотрудник.ТехНомер);
				ДБФ.FIO=Сокрлп(Сотрудник.Наименование);
				ДБФ.ID_CODE=Сокрлп(Сотрудник.ИнНомер);
				ДБФ.SUMA=Сумма;
				ДБФ.Записать();
			КонецЦИкла;
			ДБФ="";
	КонецЕсли;



//Приватбанк
    Если (Найти(СокрЛП(Банк.Наименование),"Приватбанк") > 0) Тогда
		Если СокрЛП(Подразделение.Наименование) = "ЦБ (70804)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CB";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "СЮТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SUT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "НВК (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\NVK";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "МК (70802)" Тогда
			имя=СокрЛП(Банк.Папка)+"\MK";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Логопед (70806)" Тогда
			имя=СокрЛП(Банк.Папка)+"\LOGOPED";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ДЮСШ (130107)" Тогда
			имя=СокрЛП(Банк.Папка)+"\DUSSH";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Госп. группа (70805)" Тогда
			имя=СокрЛП(Банк.Папка)+"\HG";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "БДТ (70401)" Тогда
			имя=СокрЛП(Банк.Папка)+"\BDT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Апарат (10116)" Тогда
			имя=СокрЛП(Банк.Папка)+"\APARAT";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №2 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_2";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №3 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_3";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №4 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_4";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №5 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_5";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №6 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_6";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №7 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_7";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_Я-с №8 (70101)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_8";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №1 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_1";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №2 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_2";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №3 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_3";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №4 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_4";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №6 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_6";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "_ЗОШ №7 (70201)" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_7";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Инклюзия (0611020)" Тогда
			имя=СокрЛП(Банк.Папка)+"\INCL";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ІРЦ (0611161)" Тогда
			имя=СокрЛП(Банк.Папка)+"\IRC";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Петрівський НВК" Тогда
			имя=СокрЛП(Банк.Папка)+"\SCH_P";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Петрівський НВК ДНЗ" Тогда
			имя=СокрЛП(Банк.Папка)+"\SAD_P";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "Міський центр проф.розвитку пед. працівників" Тогда
			имя=СокрЛП(Банк.Папка)+"\MCPRPP";
		ИначеЕсли СокрЛП(Подразделение.Наименование) = "ЦПХ(00000)" Тогда
			имя=СокрЛП(Банк.Папка)+"\CPH";
		КонецЕсли;


			ВыбратьСтроки();
			ПолучитьСтроку();
			врем = "_" + Сотрудник.Педагог.Получить(ПериодРаботыГл.ДатаНачала);
			Если врем = "_Да" Тогда
                имя = имя + "_y";
            Иначе
                имя = имя + "_n"
	        КонецЕсли;
            имя = имя + ".dbf";

			Если ФС.СуществуетФайл(имя)=1 Тогда
				ФС.УдалитьФайл(имя);
			КонецЕсли;
			ДБФ=СоздатьОбъект("XBASE");
			ДБФ.КодоваяСтраница(0);
			ДБФ.ДобавитьПоле("ACCT_CARD","C",29,);
			ДБФ.ДобавитьПоле("FIO","C",20,);
			ДБФ.ДобавитьПоле("ID_CODE","C",10,);
			ДБФ.ДобавитьПоле("SUMA","N",10,2);

			ДБФ.СоздатьФайл(имя);
			ВыбратьСтроки();

			Пока ПолучитьСтроку()=1 Цикл
				Если Сумма=0 Тогда
					Продолжить;
				КонецЕсли;

				ДБФ.Добавить();
				ДБФ.ACCT_CARD=Сокрлп(Сотрудник.ТехНомер);
				ДБФ.FIO=Сокрлп(Сотрудник.Наименование);
				ДБФ.ID_CODE=Сокрлп(Сотрудник.ИнНомер);
				ДБФ.SUMA=Сумма;
				ДБФ.Записать();
			КонецЦИкла;
			ДБФ="";
	КонецЕсли;

КонецПроцедуры



Форма.Заголовок("Перечисление в банки");
Форма.Подразделение.ВыборГруппы(1);