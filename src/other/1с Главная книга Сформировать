
Процедура Сформировать()
	Дата1 = НачМесяца(Дата(Год, Месяц.ТекущаяСтрока(), 1));
	Дата2 = КонМесяца(Дата(Год, Месяц.ТекущаяСтрока(), 1));
	Т_ = СоздатьОбъект("Таблица");
	Т_.ИсходнаяТаблица("Таблица1");
	Если Обл=1 Тогда
		Т_.ВывестиСекцию("Обложка");
		Т_.ТолькоПросмотр(1);
		Т_.ПараметрыСтраницы(2,,,7,7,7,7,,,,1,);
		Т_.Показать("Обложка главной книги");
	КонецЕсли;
	Для а=1 по 1000 цикл
		ИтогоК[а]=0;
		ИтогоД[а]=0;
	КонецЦикла;
	Т = СоздатьОбъект("Таблица");
	Т.ИсходнаяТаблица("Таблица");
	ИтогПоМО=0;
	СписокСчетов=СоздатьОбъект("СписокЗначений");

	Ит = СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ЖурналыГЛ);
	Ит1 = СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит1.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;

	Ит1.ИспользоватьСубконто(ВидыСубконто.Журнал,ЖурналыГЛ);
	Т.ВывестиСекцию("Шапка");
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,3);
	Т.ВывестиСекцию("ОстаткиНач|Титул");
	Ит.ВыбратьСчета(1);
	Пока Ит.ПолучитьСчет() = 1 Цикл
		Ит1.ВыполнитьЗапрос(Дата1,Дата2,ит.Счет,,,3);
		Т.ПрисоединитьСекцию("ОстаткиНач|Обороты");
		СписокСчетов.ДобавитьЗначение(Строка(Ит.Счет.Код),Строка(Ит.Счет.Код));
	КонецЦикла;
	Ит = СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(1));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо1|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(1));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо1|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит = СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(2));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо2|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(2));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо2|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит = СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(3));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо3|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(3));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо3|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит = СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(4));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо4|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(4));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо4|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(5));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо5|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(5));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо5|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(6));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо6|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(6));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо6|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	//Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(7));
	//Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	//Т.ВывестиСекцию("жо7|Титул");
	//ИтогПоМО=ИтогПоМО+ИТ.ДО();
	//i=0;
	//Пока i < СписокСчетов.РазмерСписка()  Цикл
	//	i=i+1;
	//	СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
	//	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(7));
	//	Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
	//	Т.ПрисоединитьСекцию("жо7|Обороты");
	//	ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
	//	ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	//КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(8));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо8|Титул");
	ИтогПоМО=ИтогПоМО+Ит.КО()+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(8));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо8|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(9));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо9|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(9));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо9|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(10));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо10|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(10));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо10|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(11));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо11|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(11));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо11|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(12));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо12|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(12));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо12|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(13));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо13|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(13));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо13|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(14));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо14|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(14));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо14|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(15));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо15|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(15));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо15|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(16));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо16|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(16));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо16|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;
	//**************************************************
	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(17));
	Ит.ВыполнитьЗапрос(Дата1,Дата2,,,,1);
	Т.ВывестиСекцию("жо17|Титул");
	ИтогПоМО=ИтогПоМО+ИТ.ДО();
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ПолучитьЖурналы(17));
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,2);
		Т.ПрисоединитьСекцию("жо17|Обороты");
		ИтогоК[i]=ИтогоК[i]+Ит.КорКО();
		ИтогоД[i]=ИтогоД[i]+Ит.КорДО();
	КонецЦикла;
	//**************************************************


	ит=СоздатьОбъект("БухгалтерскиеИтоги");
	Если Фирма.Выбран()=1 Тогда
		ит.ИспользоватьРазделительУчета(Фирма);
	КонецЕсли;

	Ит.ИспользоватьСубконто(ВидыСубконто.Журнал,ЖурналыГЛ);
	Т.ВывестиСекцию("Всего|Титул");
	i=0;
	Пока i < СписокСчетов.РазмерСписка()  Цикл
		i=i+1;
		СчетПолученный=СписокСчетов.ПолучитьЗначение(i);
		Ит.ВыполнитьЗапрос(Дата1,Дата2,СчетПоКоду(СчетПолученный),,,3);
		Т.ПрисоединитьСекцию("Всего|Обороты");
	КонецЦикла;

	Ит = 0;
	Т.ТолькоПросмотр(0);
	Т.ПараметрыСтраницы(2,,,5,5,5,5,,,,1,);
	//Т.Опции(0, 0, 4, 1,,"Главная книга");
	//Т.ОбластьПечати(2);
	Т.Показать("Главная книга ("+ПериодСтр(Дата1, Дата2)+")", "");
//КонецПроцедуры


КонецПроцедуры
